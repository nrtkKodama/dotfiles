Bootstrap: docker
From: ubuntu:22.04

%post
    export DEBIAN_FRONTEND=noninteractive
    
    # Install system dependencies
    apt-get update && apt-get install -y --no-install-recommends \
        ca-certificates \
        curl \
        git \
        vim \
        nano \
        build-essential \
        python3 \
        python3-pip \
        python3-venv
    
    # Install uv to /opt/uv
    export UV_INSTALL_DIR=/opt/uv
    mkdir -p ${UV_INSTALL_DIR}
    curl -LsSf https://astral.sh/uv/install.sh | INSTALLER_NO_MODIFY_PATH=1 uv_bin_dir=${UV_INSTALL_DIR} sh
    
    # Cleanup
    rm -rf /var/lib/apt/lists/*
    
    # Create /app directory
    mkdir -p /app

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export UV_LINK_MODE=copy
    export PATH="/opt/uv:${PATH}"

%runscript
    exec /bin/bash "$@"

%labels
    Author nrtkKodama
    Description Python environment with uv (Singularity compatible)

